# 蓝汛特征提取定点化计算

蓝汛SDK中的fft_hw输入是Q15的数据,输出时Q15的数据;fft的计算过程可以与numpy.fft.fft的计算对齐.

计算过程包括:预加重,加窗,fft,功率谱,fbank,log_fbank

- **生成一组随机浮点数字作为输入数组**

```python
import numpy as np
NFFT = 512
np.random.seed(0)
float_frames = np.random.uniform(-1, 1, [NFFT])
```

- **量化输入数组**

```
# |float_frames| < 1, 使用16位的Q15格式来定点化
int_frames = (float_frames * (2**15)).astype(np.int32)
```

- **预加重**

```python
pre_emphasis = 0.97
# 浮点运算后量化, |emphasized_frames| > 1, 使用32位的Q15格式来定点化
emphasized_frames = np.append(float_frames[0], float_frames[1:] - pre_emphasis * float_frames[:-1])
q_emphasized_frames = (emphasized_frames * (2 **15)).astype(np.int32)

# 定点运算移位
int_pre_emphasis = int(0.97 * 2 ** 15)
int_emphasized_frames = np.append(int_frames[0], int_frames[1:] - ((int_pre_emphasis * int_frames[:-1])>>15))
```

```
q_emphasized_frames   = [3199, 10999, -6944, -3591, -7856, 14414, -13364, 29642, 5481, -37113, 26528, -16651, 2622, 23566, -55167, 211, -5196, 52298, -2915, 6566, 7845, -10820, -21541, 20833, -42849, 33436, -32267, 51813, -26835, -6981, -10005, 32939, -20306, 7272, -35886, 38299, -131, 537, 21647, -16293, -20765, 4804, 16954, -41384, 38885, 581, -29827, -5907, 11493, 2801, 13264, -8486, 35909, -57126, 6218, -3689, 31564, -25901, 13475, -14607, -6102, -3855, 35013, -33649, 3115, 10685, 29381, -46809, 47759, -47953, 56901, -32342, 33237, -23436, 9015, -45409, 15059, -11083, 10783, -12027, 12308, 5951, -23113, 40320, -7870, -19609, 16437, -28089, 30790, 23306, -39180, 22504, -34772, 37583, -27553, -7374, 25809, -36949, 52064, -53370, 43139, -26376, 30034, 15338, -45847, 20962, 1190, -1115, -22741, 47275, -32246, 26063, -8948, -25956, 33441, -26730, 31555, -18900, 19850, -11649, 2523, -14232, 29805, -19556, -14143, 11813, -38273, 17560, 23111, -23939, 21079, -12170, -19361, 9953, 17408, 1507, -905, 5315, 229, -14163, 30347, -33887, 4215, 29762, -4847, -6102, -39160, 52904, -12625, 19073, -54685, 46410, -45520, 29028, -31999, 46720, -1982, -15007, -10475, -22334, 40326, -15595, 17505, 9895, 7872, -6910, -54618, 21863, 23973, -36140, 22253, -30544, 8669, -12482, 49855, -36763, 7415, 37885, -13816, -43676, 7786, 29276, -2661, -22086, 45118, -20134, -4909, 3627, 9365, -26953, 5284, -12545, -2120, 49071, -12549, -15853, -17257, 1229, -13349, 23797, -8165, 24831, -20493, -13226, -10783, 1855, 39266, -14438, 5340, 23670, 6918, -49724, 28684, -25877, -16369, 47405, -28220, 3804, 13196, 16081, -12591, 16222, -38530, 33928, -39548, 49658, -16496, -30563, 47404, -13309, -30801, -3146, 19417, -32243, 10982, 13660, -3458, 5611, -12257, 19823, 18328, -48195, 25452, -25217, 37601, -20597, 10894, -24915, -3141, 21794, -8703, 38042, -10609, -570, 10650, -52965, 29902, 2218, 24903, -42987, -3771, -9719, -6281, 58890, -16169, 7886, -32431, 19538, -34069, 26777, 32206, -5679, -34540, 40537, -46925, 46502, 362, -8449, -10471, 16236, -37358, 36026, -14457, -39393, 20931, -13348, 53944, -32047, 1204, 9306, -17478, -15442, 44192, -40803, 20458, -18786, -8830, 49301, 7968, 137, -2651, -7884, -28356, -16845, 20550, -11651, -7063, -5903, 43173, -46360, 48791, -40338, -5112, -166, 37364, -27624, 10979, 8811, 19982, -8040, -29484, -9550, -5712, 15262, -2977, 12247, 14799, 1169, -26623, 5892, -13263, 39179, -47385, 41081, 5741, 463, -33401, 7023, 13762, -20457, 5977, -11643, 16627, -27292, 48596, -46782, 28127, -13858, 17362, 25180, -19666, -39704, 24975, 5080, 1734, 9587, -26106, -10184, 16559, 36733, -49517, 46364, -22810, -5608, 27776, -26999, 17322, -20867, 32898, -13231, 1002, -23980, 27780, -7406, -25687, -5720, 41003, 11250, -31932, 8623, 17659, -25543, 32333, -23761, 16206, 6402, -5311, -42378, 30098, -14850, -22201, 22819, -10985, 38215, -52773, 59747, -38656, -196, -22588, 10118, 13538, 34410, -53529, 54635, -4092, -26492, -8443, -6498, 24490, -37876, -2062, 26126, -23780, 11200, -2504, 1550, -8489, -8525, 5820, 32208, 23549, 1986, -37131, -16307, 30519, -9456, 32690, -59599, 46195, -31872, -3494, 27087, -26972, 27012, -9409, -6075, 8409, -17432, 27075, -18711, -3726, 30403, 6957, -56767, 11337, 7069, 30271, 11794, -128, -3273, -39075, 45177, -47699, -9897, 54606, -46137, 29383, -41007, 43195, 10350, -39179, 6540, -549, 24295, -32998, -4837, 17537, -9590, 34659, -38749, 16828, 28853, -19353, 15552, 5501, -11549, -2861, 17981, 2652, -34586, -25060, 13700, -9611, 16692, -18918, 30262, -14299, 33361, 5522, -26665, -17737, 20358, 20139, -31334, 9341, -18275, 11596, -3608, -10239, 16377, -12799, 3733, 9707, 14835, -26841, 38381, -3218, -52609, 12544, 12130, -22486, 15203]

int_emphasized_frames = [3199, 11000, -6944, -3590, -7855, 14414, -13363, 29643, 5483, -37111, 26527, -16650, 2623, 23566, -55165, 211, -5197, 52296, -2914, 6568, 7846, -10819, -21540, 20833, -42847, 33434, -32266, 51813, -26834, -6980, -10005, 32939, -20305, 7271, -35885, 38298, -131, 538, 21649, -16292, -20764, 4805, 16954, -41383, 38885, 582, -29826, -5907, 11492, 2802, 13263, -8484, 35909, -57124, 6218, -3689, 31564, -25900, 13476, -14608, -6102, -3856, 35013, -33649, 3116, 10684, 29381, -46808, 47759, -47951, 56901, -32341, 33238, -23435, 9016, -45408, 15060, -11084, 10783, -12028, 12309, 5952, -23114, 40320, -7870, -19607, 16437, -28088, 30789, 23307, -39179, 22504, -34771, 37583, -27552, -7375, 25808, -36948, 52063, -53369, 43139, -26375, 30033, 15339, -45844, 20962, 1191, -1115, -22740, 47275, -32245, 26063, -8947, -25955, 33442, -26729, 31554, -18899, 19851, -11648, 2524, -14232, 29806, -19555, -14142, 11813, -38272, 17561, 23110, -23938, 21078, -12169, -19361, 9953, 17408, 1508, -906, 5317, 230, -14162, 30348, -33886, 4216, 29762, -4847, -6101, -39159, 52904, -12625, 19074, -54683, 46409, -45518, 29027, -31998, 46720, -1982, -15007, -10474, -22335, 40326, -15593, 17505, 9896, 7874, -6910, -54616, 21864, 23973, -36139, 22252, -30542, 8668, -12483, 49854, -36761, 7414, 37885, -13815, -43674, 7786, 29276, -2660, -22086, 45118, -20133, -4908, 3628, 9366, -26952, 5284, -12545, -2121, 49070, -12548, -15852, -17257, 1230, -13350, 23798, -8165, 24831, -20491, -13226, -10783, 1855, 39265, -14436, 5340, 23671, 6919, -49722, 28683, -25876, -16369, 47404, -28219, 3804, 13195, 16082, -12591, 16224, -38529, 33928, -39547, 49658, -16495, -30562, 47403, -13308, -30799, -3147, 19416, -32242, 10982, 13661, -3459, 5612, -12257, 19823, 18329, -48193, 25451, -25215, 37600, -20596, 10894, -24914, -3142, 21795, -8703, 38042, -10609, -569, 10652, -52963, 29901, 2219, 24904, -42984, -3773, -9720, -6282, 58889, -16168, 7887, -32429, 19537, -34067, 26777, 32206, -5679, -34539, 40537, -46923, 46501, 365, -8449, -10470, 16237, -37356, 36025, -14456, -39393, 20932, -13348, 53944, -32045, 1205, 9305, -17477, -15442, 44192, -40802, 20457, -18785, -8830, 49300, 7970, 139, -2650, -7884, -28353, -16846, 20549, -11651, -7063, -5904, 43172, -46359, 48790, -40336, -5113, -166, 37363, -27623, 10979, 8810, 19983, -8040, -29483, -9551, -5712, 15262, -2977, 12247, 14799, 1170, -26622, 5892, -13263, 39179, -47384, 41080, 5742, 465, -33400, 7024, 13761, -20455, 5978, -11644, 16627, -27292, 48595, -46781, 28126, -13856, 17361, 25181, -19664, -39703, 24975, 5081, 1734, 9589, -26105, -10184, 16559, 36733, -49516, 46364, -22809, -5606, 27776, -26997, 17322, -20866, 32898, -13230, 1003, -23979, 27779, -7406, -25686, -5719, 41002, 11251, -31930, 8623, 17661, -25542, 32333, -23760, 16207, 6404, -5310, -42377, 30097, -14849, -22201, 22820, -10985, 38214, -52772, 59746, -38653, -196, -22588, 10118, 13538, 34411, -53528, 54635, -4092, -26490, -8443, -6498, 24490, -37875, -2063, 26126, -23780, 11200, -2505, 1551, -8490, -8526, 5820, 32207, 23550, 1989, -37130, -16306, 30518, -9454, 32689, -59597, 46195, -31871, -3495, 27087, -26971, 27012, -9408, -6073, 8409, -17431, 27074, -18710, -3727, 30403, 6959, -56765, 11337, 7069, 30270, 11796, -127, -3273, -39073, 45176, -47697, -9898, 54605, -46135, 29382, -41005, 43193, 10352, -39177, 6540, -550, 24295, -32997, -4837, 17537, -9590, 34659, -38748, 16827, 28854, -19353, 15553, 5502, -11548, -2861, 17982, 2654, -34585, -25060, 13700, -9611, 16692, -18918, 30261, -14298, 33362, 5524, -26664, -17736, 20358, 20140, -31333, 9342, -18274, 11595, -3608, -10239, 16376, -12798, 3733, 9707, 14836, -26839, 38381, -3218, -52607, 12544, 12131, -22487, 15203]
```

**比较 q_emphasized_frames 和 int_emphasized_frames ,可以看到基本一致,只有细微的差距**

- **加窗**

```python
# 浮点汉明窗
window = np.hamming(NFFT)

# 定点汉明窗, |window| < 1, 使用16位的Q15格式来定点化
int_window = (window * (2 ** 15)).astype(np.int32)

# 浮点加窗量化, |window_frame| > 1, 使用32位的Q15格式来定点化
window_frame = window * emphasized_frames
window_frame_q = (window_frame * (2 ** 15)).astype(np.int32)

# 定点加窗移位
window_frame_int = window_int * int_emphasized_frames >> 15
```

```
int_window = [2621, 2622, 2625, 2631, 2639, 2649, 2662, 2677, 2694, 2713, 2735, 2759, 2785, 2813, 2844, 2877, 2912, 2949, 2989, 3030, 3074, 3121, 3169, 3220, 3273, 3328, 3385, 3444, 3505, 3569, 3635, 3703, 3773, 3845, 3919, 3995, 4074, 4154, 4237, 4321, 4408, 4496, 4587, 4679, 4774, 4870, 4968, 5069, 5171, 5275, 5381, 5489, 5598, 5710, 5823, 5938, 6055, 6174, 6294, 6416, 6540, 6666, 6793, 6922, 7052, 7184, 7318, 7453, 7590, 7728, 7868, 8009, 8152, 8296, 8442, 8589, 8737, 8887, 9038, 9190, 9344, 9499, 9655, 9813, 9971, 10131, 10292, 10454, 10617, 10781, 10946, 11112, 11280, 11448, 11617, 11787, 11958, 12130, 12303, 12476, 12650, 12825, 13001, 13178, 13355, 13533, 13711, 13890, 14070, 14250, 14431, 14612, 14793, 14975, 15158, 15341, 15524, 15708, 15891, 16076, 16260, 16445, 16629, 16814, 16999, 17185, 17370, 17555, 17741, 17926, 18111, 18296, 18482, 18667, 18851, 19036, 19221, 19405, 19589, 19773, 19956, 20139, 20322, 20504, 20686, 20867, 21048, 21229, 21409, 21588, 21767, 21945, 22122, 22299, 22475, 22651, 22825, 22999, 23172, 23345, 23516, 23686, 23856, 24025, 24192, 24359, 24525, 24690, 24853, 25016, 25177, 25338, 25497, 25655, 25812, 25967, 26121, 26274, 26426, 26577, 26726, 26873, 27020, 27165, 27308, 27450, 27591, 27730, 27867, 28003, 28138, 28270, 28402, 28531, 28659, 28786, 28910, 29033, 29155, 29274, 29392, 29508, 29622, 29734, 29845, 29954, 30061, 30166, 30269, 30370, 30469, 30567, 30662, 30756, 30847, 30937, 31024, 31110, 31193, 31275, 31354, 31431, 31507, 31580, 31651, 31720, 31787, 31851, 31914, 31974, 32033, 32089, 32143, 32194, 32244, 32291, 32336, 32379, 32420, 32458, 32495, 32529, 32560, 32590, 32617, 32642, 32665, 32685, 32703, 32719, 32733, 32744, 32754, 32760, 32765, 32767, 32767, 32765, 32760, 32754, 32744, 32733, 32719, 32703, 32685, 32665, 32642, 32617, 32590, 32560, 32529, 32495, 32458, 32420, 32379, 32336, 32291, 32244, 32194, 32143, 32089, 32033, 31974, 31914, 31851, 31787, 31720, 31651, 31580, 31507, 31431, 31354, 31275, 31193, 31110, 31024, 30937, 30847, 30756, 30662, 30567, 30469, 30370, 30269, 30166, 30061, 29954, 29845, 29734, 29622, 29508, 29392, 29274, 29155, 29033, 28910, 28786, 28659, 28531, 28402, 28270, 28138, 28003, 27867, 27730, 27591, 27450, 27308, 27165, 27020, 26873, 26726, 26577, 26426, 26274, 26121, 25967, 25812, 25655, 25497, 25338, 25177, 25016, 24853, 24690, 24525, 24359, 24192, 24025, 23856, 23686, 23516, 23345, 23172, 22999, 22825, 22651, 22475, 22299, 22122, 21945, 21767, 21588, 21409, 21229, 21048, 20867, 20686, 20504, 20322, 20139, 19956, 19773, 19589, 19405, 19221, 19036, 18851, 18667, 18482, 18296, 18111, 17926, 17741, 17555, 17370, 17185, 16999, 16814, 16629, 16445, 16260, 16076, 15891, 15708, 15524, 15341, 15158, 14975, 14793, 14612, 14431, 14250, 14070, 13890, 13711, 13533, 13355, 13178, 13001, 12825, 12650, 12476, 12303, 12130, 11958, 11787, 11617, 11448, 11280, 11112, 10946, 10781, 10617, 10454, 10292, 10131, 9971, 9813, 9655, 9499, 9344, 9190, 9038, 8887, 8737, 8589, 8442, 8296, 8152, 8009, 7868, 7728, 7590, 7453, 7318, 7184, 7052, 6922, 6793, 6666, 6540, 6416, 6294, 6174, 6055, 5938, 5823, 5710, 5598, 5489, 5381, 5275, 5171, 5069, 4968, 4870, 4774, 4679, 4587, 4496, 4408, 4321, 4237, 4154, 4074, 3995, 3919, 3845, 3773, 3703, 3635, 3569, 3505, 3444, 3385, 3328, 3273, 3220, 3169, 3121, 3074, 3030, 2989, 2949, 2912, 2877, 2844, 2813, 2785, 2759, 2735, 2713, 2694, 2677, 2662, 2649, 2639, 2631, 2625, 2622, 2621]

window_frame_q   = [255, 880, -556, -288, -632, 1165, -1085, 2421, 450, -3073, 2214, -1402, 222, 2023, -4788, 18, -461, 4707, -265, 607, 736, -1030, -2083, 2047, -4280, 3395, -3333, 5446, -2871, -760, -1109, 3722, -2338, 853, -4292, 4670, -16, 68, 2799, -2148, -2793, 659, 2373, -5910, 5665, 86, -4523, -913, 1813, 451, 2178, -1421, 6135, -9955, 1105, -668, 5833, -4880, 2588, -2860, -1218, -784, 7258, -7108, 670, 2342, 6562, -10647, 11063, -11310, 13663, -7905, 8269, -5933, 2322, -11903, 4015, -3006, 2974, -3373, 3510, 1725, -6810, 12074, -2395, -6062, 5162, -8961, 9976, 7668, -13088, 7632, -11970, 13130, -9768, -2652, 9418, -13678, 19547, -20321, 16655, -10324, 11916, 6168, -18685, 8657, 498, -473, -9764, 20559, -14201, 11622, -4039, -11862, 15470, -12514, 14949, -9060, 9627, -5715, 1252, -7142, 15126, -10035, -7337, 6195, -20288, 9408, 12512, -13096, 11650, -6795, -10920, 5670, 10015, 875, -531, 3147, 137, -8546, 18482, -20827, 2614, 18623, -3060, -3886, -25155, 34275, -8249, 12565, -36326, 31081, -30732, 19754, -21948, 32296, -1380, -10533, -7408, -15912, 28941, -11273, 12745, 7255, 5812, -5137, -40879, 16474, 18183, -27591, 17098, -23618, 6746, -9773, 39272, -29133, 5911, 30378, -11142, -35424, 6350, 24010, -2194, -18310, 37601, -16866, -4133, 3069, 7965, -23034, 4537, -10823, -1837, 42727, -10976, -13927, -15226, 1089, -11877, 21260, -7323, 22361, -18526, -12001, -9821, 1696, 36022, -13292, 4933, 21939, 6433, -46384, 26841, -24289, -15409, 44756, -26719, 3611, 12562, 15348, -12048, 15561, -37048, 32699, -38201, 48070, -16002, -29708, 46169, -12987, -30110, -3081, 19047, -31679, 10806, 13461, -3413, 5545, -12127, 19636, 18176, -47844, 25291, -25080, 37428, -20518, 10860, -24852, -3135, 21762, -8694, 38016, -10605, -570, 10649, -52964, 29902, 2218, 24897, -42968, -3769, -9709, -6272, 58775, -16128, 7861, -32307, 19448, -33884, 26608, 31971, -5632, -34214, 40107, -46369, 45890, 357, -8314, -10288, 15927, -36584, 35218, -14107, -38367, 20346, -12948, 52220, -30955, 1160, 8948, -16766, -14775, 42179, -38842, 19423, -17787, -8337, 46412, 7479, 128, -2473, -7331, -26281, -15561, 18918, -10689, -6456, -5377, 39176, -41909, 43937, -36182, -4567, -147, 33106, -24372, 9645, 7706, 17398, -6969, -25438, -8201, -4881, 12979, -2519, 10312, 12398, 974, -22070, 4858, -10877, 31955, -38432, 33131, 4603, 369, -26469, 5532, 10775, -15917, 4622, -8946, 12693, -20700, 36616, -35014, 20909, -10231, 12730, 18332, -14215, -28494, 17793, 3593, 1217, 6678, -18046, -6985, 11269, 24800, -33163, 30799, -15028, -3664, 17995, -17343, 11031, -13173, 20586, -8206, 616, -14604, 16763, -4427, -15212, -3355, 23821, 6472, -18191, 4864, 9860, -14118, 17688, -12864, 8682, 3394, -2785, -21985, 15445, -7536, -11142, 11323, -5389, 18533, -25298, 28306, -18097, -90, -10323, 4568, 6037, 15154, -23279, 23459, -1735, -11085, -3487, -2648, 9849, -15028, -807, 10086, -9054, 4205, -927, 566, -3053, -3022, 2033, 11087, 7986, 663, -12217, -5283, 9736, -2970, 10107, -18136, 13834, -9391, -1013, 7724, -7565, 7450, -2552, -1619, 2204, -4491, 6855, -4655, -910, 7300, 1641, -13149, 2578, 1578, 6637, 2538, -27, -678, -7949, 9017, -9340, -1901, 10289, -8526, 5325, -7288, 7527, 1768, -6563, 1074, -88, 3834, -5104, -733, 2606, -1397, 4949, -5424, 2309, 3881, -2552, 2011, 697, -1436, -348, 2150, 311, -3982, -2832, 1519, -1047, 1785, -1988, 3126, -1452, 3332, 542, -2579, -1689, 1910, 1862, -2858, 840, -1624, 1018, -313, -879, 1392, -1077, 311, 803, 1219, -2193, 3118, -260, -4238, 1007, 972, -1799, 1216]

window_frame_int = [255, 880, -557, -289, -633, 1165, -1086, 2421, 450, -3073, 2214, -1402, 222, 2023, -4788, 18, -462, 4706, -266, 607, 736, -1031, -2084, 2047, -4280, 3395, -3334, 5445, -2871, -761, -1110, 3722, -2338, 853, -4292, 4669, -17, 68, 2799, -2149, -2794, 659, 2373, -5910, 5665, 86, -4522, -914, 1813, 451, 2177, -1422, 6134, -9955, 1104, -669, 5832, -4880, 2588, -2861, -1218, -785, 7258, -7109, 670, 2342, 6561, -10647, 11062, -11309, 13662, -7905, 8268, -5934, 2322, -11903, 4015, -3007, 2974, -3374, 3509, 1725, -6811, 12074, -2395, -6062, 5162, -8961, 9975, 7668, -13088, 7631, -11970, 13130, -9768, -2653, 9418, -13678, 19547, -20320, 16653, -10323, 11915, 6168, -18685, 8657, 498, -473, -9765, 20558, -14201, 11622, -4040, -11862, 15469, -12514, 14948, -9060, 9626, -5715, 1252, -7143, 15125, -10035, -7337, 6195, -20288, 9408, 12512, -13096, 11649, -6795, -10921, 5669, 10014, 876, -532, 3148, 137, -8546, 18482, -20827, 2614, 18623, -3060, -3886, -25154, 34274, -8249, 12566, -36325, 31080, -30730, 19753, -21947, 32295, -1381, -10534, -7407, -15913, 28940, -11272, 12744, 7255, 5813, -5137, -40877, 16474, 18182, -27590, 17097, -23617, 6744, -9774, 39270, -29132, 5910, 30376, -11142, -35423, 6350, 24009, -2194, -18310, 37600, -16866, -4133, 3070, 7965, -23033, 4537, -10823, -1839, 42725, -10975, -13926, -15226, 1089, -11879, 21260, -7324, 22360, -18524, -12002, -9822, 1695, 36021, -13290, 4932, 21938, 6433, -46383, 26839, -24288, -15410, 44755, -26718, 3611, 12560, 15349, -12048, 15562, -37047, 32697, -38199, 48069, -16002, -29707, 46167, -12986, -30109, -3082, 19045, -31678, 10806, 13462, -3414, 5545, -12127, 19635, 18176, -47842, 25289, -25079, 37426, -20517, 10859, -24851, -3136, 21762, -8694, 38014, -10605, -569, 10651, -52962, 29900, 2218, 24897, -42966, -3771, -9710, -6273, 58772, -16128, 7862, -32305, 19446, -33882, 26607, 31971, -5632, -34213, 40106, -46366, 45887, 359, -8314, -10287, 15927, -36582, 35216, -14106, -38367, 20346, -12949, 52218, -30953, 1161, 8946, -16764, -14776, 42178, -38841, 19421, -17786, -8337, 46409, 7480, 130, -2473, -7331, -26279, -15562, 18917, -10689, -6457, -5378, 39174, -41909, 43936, -36181, -4568, -148, 33104, -24371, 9644, 7705, 17399, -6969, -25436, -8202, -4882, 12979, -2520, 10312, 12397, 975, -22070, 4858, -10877, 31954, -38432, 33129, 4604, 370, -26468, 5532, 10773, -15917, 4622, -8947, 12693, -20700, 36615, -35013, 20908, -10230, 12728, 18332, -14214, -28493, 17793, 3593, 1217, 6679, -18046, -6986, 11268, 24798, -33162, 30798, -15027, -3663, 17994, -17342, 11030, -13173, 20585, -8205, 616, -14604, 16762, -4428, -15212, -3355, 23819, 6472, -18190, 4863, 9861, -14118, 17688, -12864, 8682, 3394, -2785, -21984, 15443, -7536, -11142, 11323, -5390, 18532, -25298, 28304, -18097, -91, -10323, 4567, 6036, 15154, -23279, 23459, -1735, -11085, -3487, -2649, 9848, -15028, -808, 10085, -9054, 4205, -928, 566, -3054, -3023, 2033, 11086, 7986, 664, -12217, -5284, 9736, -2970, 10106, -18135, 13833, -9391, -1014, 7724, -7565, 7450, -2552, -1620, 2204, -4491, 6854, -4655, -911, 7300, 1641, -13149, 2578, 1578, 6636, 2538, -27, -679, -7949, 9016, -9340, -1902, 10288, -8526, 5324, -7287, 7526, 1768, -6563, 1073, -89, 3833, -5105, -734, 2606, -1398, 4949, -5425, 2308, 3881, -2553, 2011, 697, -1436, -349, 2150, 311, -3983, -2832, 1519, -1047, 1785, -1989, 3126, -1453, 3332, 542, -2579, -1690, 1909, 1862, -2859, 840, -1624, 1018, -314, -879, 1391, -1078, 311, 803, 1219, -2193, 3117, -261, -4237, 1007, 971, -1800, 1216]
```

- **fft 计算,包括定点和浮点的计算**

```python
# 浮点fft计算 量化
fft_out_float = np.fft.fft(window_frame, NFFT)[: int(NFFT / 2) + 1]
# |fft_out_float| > 1, 使用32位的Q15格式来定点化
fft_out_q = fft_out_float * (2 ** 15).astype(np.int32)

# 定点fft计算
fft_out_int = np.fft.fft(window_frame_int, NFFT)[: int(NFFT / 2) + 1]
```

```
fft_out_q   = [ (-5550+0j),  (4052-1973j),  (-2456+498j),  (-10139-1318j),  (17353+25109j),  (-23642-13073j),  (20655-27770j),  (1835+25881j),  (5686-12432j),  (-34898+20098j),  (24840-28233j),  (7707+6265j),  (527-9972j),  (-37976-7559j),  (35833+56227j),  (11437-43942j),  (-33591+4145j),  (47752+24062j),  (-65821-22673j),  (77499+26480j),  (-86287-36907j),  (13030-45198j),  (-30212+73255j),  (142631-63577j),  (-76675+79143j),  (-24585-20784j),  (53873-8514j),  (-52964-65916j),  (73502+71294j),  (-99493+87016j),  (11347-63458j),  (75260-37889j),  (-23334+78321j),  (-9418-219389j),  (-56999+176160j),  (48661-73520j),  (-62463-34651j),  (35962-17777j),  (26992-32561j),  (68684+57082j),  (-81913-60824j),  (60121+93442j),  (-94645-57746j),  (127359-20062j),  (-162587+133505j),  (152713-163936j),  (-174427+44502j),  (194563+10611j),  (-105073+3412j),  (-121091-3771j),  (167572+60024j),  (-155622+4084j),  (170793-44244j),  (-85241+135551j),  (-28785-237640j),  (91165+45258j),  (-31994+222010j),  (251354-220205j),  (-282483+282817j),  (91711-235598j),  (74140-30572j),  (35988+209068j),  (-78559-218373j),  (-32768+164177j),  (122311-69408j),  (-19911-123785j),  (-18992+277457j),  (-45362-233385j),  (-58848-19552j),  (-32950+208994j),  (111309-222602j),  (-109857+55925j),  (302660+119770j),  (-258243-23457j),  (164304-117451j),  (-286987+215863j),  (239986-205302j),  (-14416-34050j),  (-160342-42400j),  (100419+459751j),  (153185-297985j),  (-332163+137601j),  (324318-43154j),  (-218119-33199j),  (279910-3736j),  (-225628+219909j),  (131502-374182j),  (-92372+274172j),  (255357-260772j),  (-273685+348083j),  (64140-344560j),  (-10842+349912j),  (-170476-149883j),  (316218-51266j),  (-102117-79152j),  (77870+131815j),  (-115212-17896j),  (-40121-104537j),  (25209+138483j),  (-139702-230915j),  (267176+100581j),  (123310-2123j),  (-331316-99060j),  (240715+1961j),  (-65759+117430j),  (-40371-168314j),  (32589+13916j),  (24825+292653j),  (-220215-304672j),  (-8382+212970j),  (152259-83519j),  (-123541+235454j),  (-48166-280631j),  (116109-53859j),  (-231379+183275j),  (84707-22346j),  (125018-158437j),  (82702+164599j),  (-90293-34664j),  (111276+164765j),  (-361365-388256j),  (101760+307189j),  (316561-153516j),  (-293346-385401j),  (176094+406501j),  (16204+231623j),  (-63944-392913j),  (-83397+295611j),  (201612-218776j),  (13761+135462j),  (-276539+131956j),  (-12353-416705j),  (271397+164011j),  (159878+25277j),  (-488687+101719j),  (408885-180859j),  (-69978+81229j),  (-57278-188752j),  (-40965+342792j),  (-9630-65064j),  (6665-297371j),  (-12540+317047j),  (97376-377083j),  (-164418+106381j),  (28425-33170j),  (-47403+83479j),  (45349-215860j),  (168625+425784j),  (1543-127225j),  (-418524-28052j),  (813906+47434j),  (-346932-268191j),  (31907+113073j),  (209022+99327j),  (-170725-27987j),  (-145614+56165j),  (20468+200274j),  (226254-466475j),  (-240909+184124j),  (100666+397716j),  (138340-711904j),  (-23564+755310j),  (306206-799368j),  (-464924+511048j),  (-3609-33734j),  (339995-137656j),  (-230021-140235j),  (361587+219392j),  (-487671+173301j),  (249080-413431j),  (13916+121076j),  (-144679+315400j),  (-248181-220486j),  (487583-11081j),  (-201414+144350j),  (122473-115301j),  (-83597-872j),  (216571+14595j),  (-410152+114385j),  (101157+30659j),  (1418+105856j),  (-18799-117270j),  (-216820-277730j),  (-24677+453839j),  (456706-109822j),  (-617628+43419j),  (803253-103517j),  (-917032+46415j),  (509749+50870j),  (10662+21771j),  (-32347-96011j),  (-29216+203769j),  (-497469-374309j),  (765900+299413j),  (-571044-194981j),  (266991+99326j),  (-412669+128446j),  (354140-76858j),  (306293+304481j),  (-459686-218168j),  (-55329-199843j),  (40468-5234j),  (354046+238937j),  (-106457+3808j),  (148083+381319j),  (-218158-105578j),  (-190808-537656j),  (61711+184550j),  (187258+211163j),  (106973-155443j),  (30063-263331j),  (6939+178977j),  (158161-85566j),  (-603091+14258j),  (643354+314526j),  (-499373-249311j),  (227465+124383j),  (-341585-247385j),  (322181+88483j),  (-816468-177905j),  (1155598+328424j),  (-73054-425554j),  (-376711+160004j),  (-298382-173155j),  (300965+489263j),  (-380671-403885j),  (366514+263066j),  (78408-544709j),  (-40837+68523j),  (-5310+763614j),  (-224530-394204j),  (495674-362139j),  (-145715+1341j),  (-461255+494004j),  (460227+192490j),  (-16337-770396j),  (-17655+772834j),  (-239826-827216j),  (413075+533141j),  (-748329+99463j),  (186522-366901j),  (626857+587955j),  (-525565-427266j),  (-357066+201658j),  (759031-301831j),  (-340747+240996j),  (-33126-230858j),  (-18039+1060893j),  (317934-1314176j),  (61428+448906j),  (42119-4365j),  (29462-96542j),  (-477237-147156j),  (31868-75961j),  (-64435+345824j),  (-57040-53066j),  (320672+0j)]

fft_out_int = [ (-5672+0j),  (3999-1975j),  (-2461+495j),  (-10140-1314j),  (17369+25095j),  (-23657-13073j),  (20660-27780j),  (1845+25880j),  (5672-12433j),  (-34902+20107j),  (24833-28233j),  (7715+6259j),  (521-9979j),  (-37966-7551j),  (35838+56217j),  (11428-43947j),  (-33575+4149j),  (47748+24054j),  (-65826-22670j),  (77501+26469j),  (-86294-36888j),  (13025-45195j),  (-30207+73264j),  (142613-63593j),  (-76664+79150j),  (-24575-20792j),  (53856-8522j),  (-52971-65910j),  (73518+71285j),  (-99487+87022j),  (11338-63446j),  (75254-37903j),  (-23320+78332j),  (-9427-219381j),  (-56987+176154j),  (48654-73524j),  (-62453-34637j),  (35971-17785j),  (26988-32568j),  (68667+57075j),  (-81920-60808j),  (60127+93431j),  (-94643-57723j),  (127355-20056j),  (-162564+133514j),  (152700-163933j),  (-174416+44508j),  (194544+10606j),  (-105062+3410j),  (-121090-3758j),  (167561+60009j),  (-155623+4088j),  (170786-44237j),  (-85235+135537j),  (-28785-237635j),  (91159+45251j),  (-31991+221997j),  (251327-220213j),  (-282456+282812j),  (91698-235577j),  (74125-30574j),  (35993+209046j),  (-78564-218354j),  (-32765+164165j),  (122308-69407j),  (-19915-123781j),  (-18975+277445j),  (-45354-233369j),  (-58838-19548j),  (-32949+208983j),  (111292-222595j),  (-109860+55920j),  (302656+119754j),  (-258241-23436j),  (164299-117458j),  (-286982+215849j),  (239968-205278j),  (-14414-34060j),  (-160345-42399j),  (100434+459719j),  (153166-297973j),  (-332141+137599j),  (324303-43157j),  (-218118-33194j),  (279892-3748j),  (-225611+219897j),  (131495-374160j),  (-92368+274161j),  (255331-260771j),  (-273651+348065j),  (64134-344538j),  (-10841+349901j),  (-170471-149882j),  (316210-51263j),  (-102120-79148j),  (77872+131808j),  (-115204-17887j),  (-40117-104534j),  (25212+138481j),  (-139690-230897j),  (267149+100572j),  (123303-2130j),  (-331292-99031j),  (240708+1951j),  (-65759+117433j),  (-40355-168306j),  (32572+13911j),  (24854+292646j),  (-220217-304655j),  (-8359+212950j),  (152249-83522j),  (-123517+235443j),  (-48160-280627j),  (116098-53858j),  (-231352+183270j),  (84692-22348j),  (125012-158431j),  (82696+164588j),  (-90296-34663j),  (111277+164759j),  (-361349-388222j),  (101766+307170j),  (316538-153513j),  (-293338-385363j),  (176087+406468j),  (16208+231621j),  (-63947-392902j),  (-83382+295587j),  (201591-218757j),  (13772+135450j),  (-276524+131956j),  (-12365-416657j),  (271384+163994j),  (159870+25275j),  (-488665+101719j),  (408869-180838j),  (-69982+81230j),  (-57266-188743j),  (-40975+342766j),  (-9616-65060j),  (6646-297342j),  (-12533+317033j),  (97363-377056j),  (-164414+106383j),  (28424-33159j),  (-47409+83463j),  (45348-215841j),  (168617+425758j),  (1531-127219j),  (-418499-28046j),  (813855+47429j),  (-346921-268178j),  (31908+113078j),  (209015+99317j),  (-170721-27995j),  (-145611+56167j),  (20475+200274j),  (226229-466458j),  (-240897+184119j),  (100658+397700j),  (138320-711877j),  (-23562+755288j),  (306182-799328j),  (-464904+511011j),  (-3599-33723j),  (339962-137647j),  (-230006-140228j),  (361555+219368j),  (-487639+173294j),  (249060-413421j),  (13916+121059j),  (-144676+315395j),  (-248167-220483j),  (487546-11097j),  (-201421+144340j),  (122481-115293j),  (-83592-870j),  (216549+14589j),  (-410118+114382j),  (101157+30638j),  (1429+105849j),  (-18814-117250j),  (-216804-277730j),  (-24664+453807j),  (456674-109834j),  (-617584+43431j),  (803205-103530j),  (-916969+46446j),  (509724+50857j),  (10672+21759j),  (-32346-95995j),  (-29229+203759j),  (-497440-374285j),  (765854+299396j),  (-571030-194967j),  (266987+99309j),  (-412645+128445j),  (354108-76862j),  (306304+304468j),  (-459671-218155j),  (-55332-199822j),  (40459-5249j),  (354021+238915j),  (-106451+3799j),  (148063+381280j),  (-218138-105574j),  (-190792-537616j),  (61698+184539j),  (187257+211160j),  (106952-155426j),  (30055-263323j),  (6941+178970j),  (158150-85564j),  (-603048+14266j),  (643313+314507j),  (-499355-249286j),  (227460+124362j),  (-341566-247347j),  (322154+88480j),  (-816445-177888j),  (1155534+328396j),  (-73055-425526j),  (-376669+160008j),  (-298348-173150j),  (300981+489222j),  (-380662-403857j),  (366499+263055j),  (78393-544656j),  (-40846+68511j),  (-5307+763581j),  (-224512-394169j),  (495646-362124j),  (-145720+1332j),  (-461225+493980j),  (460205+192473j),  (-16352-770356j),  (-17648+772800j),  (-239821-827185j),  (413044+533129j),  (-748282+99449j),  (186526-366894j),  (626824+587925j),  (-525544-427237j),  (-357039+201640j),  (758979-301822j),  (-340726+240977j),  (-33136-230849j),  (-18038+1060828j),  (317906-1314098j),  (61422+448892j),  (42113-4353j),  (29466-96562j),  (-477212-147108j),  (31880-75983j),  (-64409+345818j),  (-57033-53076j),  (320626+0j)]
```

**比较 fft_out_q 和 fft_out_int ,可以看到基本一致,只有细微的差距**

- **功率谱计算**

```python
# 浮点计算量化
power_spec_float = np.abs(fft_out_float)
# |power_spec_q| > 1, 使用32位的Q15格式来定点化
power_spec_q = (power_spec_float * (2 ** 15)).astype(np.int32)

# 定点计算
power_spec_int = np.abs(fft_out_int).astype(np.int32)

# int32 -> int8缩放, 先左移放大, 再右移缩小(因为实际计算中有些需要的是8位的数据)
# Q15 移位 14 最终得到 8位Q1
shift_32 = 31 - int(np.log2(power_spec_int.max())) - 1
shift_8 = 31 - 7 - shift_32
power_spec_int8 = power_spec_int >> shift_8

# 浮点直接量化8位, Q = 15 - shift_8
power_spec_q8 = (power_spec_float * (2 ** (15 - shift_8))).astype(np.int32)
```

``` [1 * 257]
power_spec_q   = [5550, 4507, 2506, 10224, 30522, 27016, 34609, 25946, 13670, 40271, 37605, 9932, 9986, 38721, 66675, 45406, 33846, 53473, 69617, 81898, 93848, 47039, 79241, 156159, 110194, 32194, 54542, 84559, 102399, 132177, 64465, 84260, 81723, 219591, 185152, 88165, 71431, 40116, 42294, 89308, 102026, 111113, 110871, 128929, 210376, 224045, 180015, 194852, 105128, 121150, 177998, 155675, 176431, 160126, 239377, 101781, 224304, 334170, 399728, 252819, 80196, 212143, 232074, 167415, 140633, 125376, 278107, 237753, 62011, 211576, 248881, 123273, 325497, 259306, 201967, 359108, 315820, 36976, 165854, 470590, 335054, 359536, 327177, 220631, 279935, 315068, 396617, 289315, 364978, 442793, 350480, 350080, 226996, 320347, 129201, 153098, 116593, 111972, 140759, 269886, 285481, 123329, 345808, 240723, 134589, 173088, 35436, 293704, 375925, 213134, 173661, 265897, 284735, 127993, 295172, 87605, 201822, 184208, 96719, 198822, 530403, 323605, 351821, 484341, 443004, 232189, 398082, 307150, 297507, 136160, 306409, 416888, 317106, 161864, 499161, 447099, 107215, 197251, 345231, 65773, 297445, 317295, 389454, 195832, 43683, 95999, 220572, 457960, 127235, 419463, 815287, 438507, 117488, 231422, 173004, 156071, 201317, 518449, 303214, 410258, 725221, 755677, 856009, 690887, 33927, 366805, 269399, 422940, 517548, 482666, 121873, 347001, 331976, 487709, 247800, 168208, 83602, 217062, 425804, 105701, 105865, 118767, 352342, 454510, 469725, 619152, 809896, 918206, 512281, 24242, 101314, 205853, 622562, 822345, 603415, 284868, 432197, 362385, 431885, 508831, 207360, 40805, 427129, 106525, 409063, 242362, 570510, 194595, 282234, 188695, 265041, 179111, 179823, 603259, 716123, 558148, 259252, 421758, 334110, 835625, 1201362, 431779, 409283, 344985, 574420, 555008, 451150, 550324, 79770, 763633, 453664, 613871, 145721, 675867, 498860, 770569, 773035, 861279, 674441, 754910, 411591, 859442, 677330, 410076, 816842, 417358, 233222, 1061047, 1352088, 453090, 42345, 100938, 499410, 82375, 351776, 77908, 320672]

power_spec_int = [5672, 4461, 2510, 10225, 30519, 27029, 34620, 25946, 13666, 40280, 37600, 9935, 9993, 38709, 66669, 45409, 33830, 53465, 69620, 81897, 93848, 47035, 79247, 156149, 110191, 32191, 54526, 84558, 102403, 132176, 64452, 84260, 81730, 219584, 185143, 88165, 71415, 40128, 42298, 89290, 102023, 111106, 110857, 128924, 210364, 224034, 180006, 194832, 105117, 121148, 177983, 155677, 176423, 160110, 239372, 101772, 224290, 334154, 399705, 252795, 80183, 212122, 232057, 167403, 140630, 125373, 278093, 237735, 62000, 211565, 248867, 123273, 325487, 259302, 201967, 359095, 315790, 36985, 165856, 470562, 335034, 359515, 327163, 220629, 279917, 315048, 396594, 289302, 364960, 442758, 350456, 350069, 226991, 320339, 129201, 153093, 116585, 111967, 140757, 269864, 285453, 123321, 345777, 240716, 134591, 173076, 35418, 293699, 375912, 213114, 173654, 265876, 284730, 127982, 295147, 87592, 201813, 184196, 96721, 198817, 530368, 323589, 351800, 484305, 442971, 232188, 398072, 307122, 297478, 136148, 306395, 416840, 317086, 161855, 499139, 447076, 107218, 197239, 345206, 65767, 297416, 317281, 389424, 195830, 43674, 95988, 220553, 457932, 127228, 419437, 815236, 438490, 117494, 231411, 173002, 156068, 201318, 518424, 303201, 410240, 725190, 755656, 855963, 690846, 33914, 366771, 269383, 422900, 517516, 482647, 121856, 346994, 331964, 487672, 247799, 168208, 83596, 217040, 425770, 105695, 105859, 118750, 352332, 454477, 469696, 619109, 809850, 918145, 512255, 24236, 101299, 205845, 622524, 822296, 603396, 284859, 432173, 362354, 431884, 508812, 207341, 40799, 427097, 106519, 409020, 242343, 570467, 194580, 282230, 188670, 265032, 179105, 179813, 603217, 716077, 558121, 259238, 421720, 334084, 835600, 1201292, 431752, 409246, 344953, 574394, 554981, 451132, 550268, 79763, 763599, 453625, 613840, 145726, 675829, 498833, 770529, 773001, 861249, 674412, 754862, 411586, 859397, 677295, 410043, 816790, 417330, 233215, 1060981, 1352005, 453075, 42338, 100957, 499372, 82400, 351765, 77910, 320626]

power_spec_int8  = [0, 0, 0, 0, 1, 1, 2, 1, 0, 2, 2, 0, 0, 2, 4, 2, 2, 3, 4, 4, 5, 2, 4, 9, 6, 1, 3, 5, 6, 8, 3, 5, 4, 13, 11, 5, 4, 2, 2, 5, 6, 6, 6, 7, 12, 13, 10, 11, 6, 7, 10, 9, 10, 9, 14, 6, 13, 20, 24, 15, 4, 12, 14, 10, 8, 7, 16, 14, 3, 12, 15, 7, 19, 15, 12, 21, 19, 2, 10, 28, 20, 21, 19, 13, 17, 19, 24, 17, 22, 27, 21, 21, 13, 19, 7, 9, 7, 6, 8, 16, 17, 7, 21, 14, 8, 10, 2, 17, 22, 13, 10, 16, 17, 7, 18, 5, 12, 11, 5, 12, 32, 19, 21, 29, 27, 14, 24, 18, 18, 8, 18, 25, 19, 9, 30, 27, 6, 12, 21, 4, 18, 19, 23, 11, 2, 5, 13, 27, 7, 25, 49, 26, 7, 14, 10, 9, 12, 31, 18, 25, 44, 46, 52, 42, 2, 22, 16, 25, 31, 29, 7, 21, 20, 29, 15, 10, 5, 13, 25, 6, 6, 7, 21, 27, 28, 37, 49, 56, 31, 1, 6, 12, 37, 50, 36, 17, 26, 22, 26, 31, 12, 2, 26, 6, 24, 14, 34, 11, 17, 11, 16, 10, 10, 36, 43, 34, 15, 25, 20, 51, 73, 26, 24, 21, 35, 33, 27, 33, 4, 46, 27, 37, 8, 41, 30, 47, 47, 52, 41, 46, 25, 52, 41, 25, 49, 25, 14, 64, 82, 27, 2, 6, 30, 5, 21, 4, 19]

power_spec_q8    = [0, 0, 0, 0, 1, 1, 2, 1, 0, 2, 2, 0, 0, 2, 4, 2, 2, 3, 4, 4, 5, 2, 4, 9, 6, 1, 3, 5, 6, 8, 3, 5, 4, 13, 11, 5, 4, 2, 2, 5, 6, 6, 6, 7, 12, 13, 10, 11, 6, 7, 10, 9, 10, 9, 14, 6, 13, 20, 24, 15, 4, 12, 14, 10, 8, 7, 16, 14, 3, 12, 15, 7, 19, 15, 12, 21, 19, 2, 10, 28, 20, 21, 19, 13, 17, 19, 24, 17, 22, 27, 21, 21, 13, 19, 7, 9, 7, 6, 8, 16, 17, 7, 21, 14, 8, 10, 2, 17, 22, 13, 10, 16, 17, 7, 18, 5, 12, 11, 5, 12, 32, 19, 21, 29, 27, 14, 24, 18, 18, 8, 18, 25, 19, 9, 30, 27, 6, 12, 21, 4, 18, 19, 23, 11, 2, 5, 13, 27, 7, 25, 49, 26, 7, 14, 10, 9, 12, 31, 18, 25, 44, 46, 52, 42, 2, 22, 16, 25, 31, 29, 7, 21, 20, 29, 15, 10, 5, 13, 25, 6, 6, 7, 21, 27, 28, 37, 49, 56, 31, 1, 6, 12, 37, 50, 36, 17, 26, 22, 26, 31, 12, 2, 26, 6, 24, 14, 34, 11, 17, 11, 16, 10, 10, 36, 43, 34, 15, 25, 20, 51, 73, 26, 24, 21, 35, 33, 27, 33, 4, 46, 27, 37, 8, 41, 30, 47, 47, 52, 41, 46, 25, 52, 41, 25, 49, 25, 14, 64, 82, 27, 2, 6, 30, 5, 21, 4, 19]
```

**比较 power_spec_q 和 power_spec_int , 可以看到基本一致,只有细微的差距**

- **梅尔滤波器组系数**

```python
# 浮点滤波器系数
nfilt = 40
low_freq_mel = 0
high_freq_mel = (2595 * np.log10(1 + (sample_rate / 2) / 700))  # Convert Hz to Mel
mel_points = np.linspace(low_freq_mel, high_freq_mel, nfilt + 2)  # Equally spaced in Mel scale
hz_points = (700 * (10 ** (mel_points / 2595) - 1))  # Convert Mel to Hz
bin = np.floor((NFFT + 1) * hz_points / sample_rate)

melbank = np.zeros((nfilt, int(np.floor(NFFT / 2 + 1))))
for m in range(1, nfilt + 1):
    f_m_minus = int(bin[m - 1])  # left
    f_m = int(bin[m])  # center
    f_m_plus = int(bin[m + 1])  # right

    for k in range(f_m_minus, f_m):
        melbank[m - 1, k] = (k - bin[m - 1]) / (bin[m] - bin[m - 1])
    for k in range(f_m, f_m_plus):
        melbank[m - 1, k] = (bin[m + 1] - k) / (bin[m + 1] - bin[m])

# 定点滤波器系数
# |melbank| <= 1, 可使用8位的Q7格式来定点化,其中1.0用最大的127表示
melbank_int = (np.clip(fbank * (2**7), 0, 127)).astype(np.int32)
```

``` 40 * 257
melbank_int = [
0,127,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,127,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,64,127,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,64,127,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,64,127,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,64,127,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,64,127,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,64,127,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,127,85,42,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,42,85,127,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,127,85,42,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,42,85,127,85,42,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,42,85,127,85,42,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,42,85,127,85,42,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,42,85,127,96,64,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,64,96,127,96,64,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,64,96,127,96,64,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,64,96,127,96,64,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,64,96,127,102,76,51,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,51,76,102,127,102,76,51,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,51,76,102,127,102,76,51,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,51,76,102,127,102,76,51,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,51,76,102,127,106,85,64,42,21,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,42,64,85,106,127,106,85,64,42,21,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,42,64,85,106,127,109,91,73,54,36,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,36,54,73,91,109,127,109,91,73,54,36,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,36,54,73,91,109,127,112,96,80,64,48,32,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,32,48,64,80,96,112,127,109,91,73,54,36,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,36,54,73,91,109,127,113,99,85,71,56,42,28,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,28,42,56,71,85,99,113,127,113,99,85,71,56,42,28,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,28,42,56,71,85,99,113,127,113,99,85,71,56,42,28,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,28,42,56,71,85,99,113,127,116,104,93,81,69,58,46,34,23,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,23,34,46,58,69,81,93,104,116,127,115,102,89,76,64,51,38,25,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,25,38,51,64,76,89,102,115,127,117,106,96,85,74,64,53,42,32,21,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,21,32,42,53,64,74,85,96,106,117,127,117,106,96,85,74,64,53,42,32,21,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,21,32,42,53,64,74,85,96,106,117,127,118,108,98,88,78,68,59,49,39,29,19,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,19,29,39,49,59,68,78,88,98,108,118,127,118,109,100,91,82,73,64,54,45,36,27,18,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,18,27,36,45,54,64,73,82,91,100,109,118,127,119,110,102,93,85,76,68,59,51,42,34,25,17,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,17,25,34,42,51,59,68,76,85,93,102,110,119,127,119,110,102,93,85,76,68,59,51,42,34,25,17,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,17,25,34,42,51,59,68,76,85,93,102,110,119,127,120,112,105,97,90,82,75,67,60,52,45,37,30,22,15,7,0,
```

- **fbank计算**

```python
# 浮点计算,量化
fbank = np.matmul(melbank, power_spec_float)
# |fbank| > 1, 使用32位的Q22格式来定点化;(定点运算中是 Q15 * Q7 = Q22)
fbank_q = (fbank * (2**22)).astype(np.int32)
# 量化移位缩放, 由32 -> 8, 先放大后缩小
shift_32_2 = 31 - int(np.log2(fbank_q.max())) - 1
shift_8_2 = 31 - 7 - shift_32_2
fbank_q8 = fbank_q >> shift_8_2

# 无缩放的定点计算
# Q7 * Q15 = Q22
fbank_int = np.matmul(melbank_int, power_spec_int)

# 缩放的定点计算, 两个8位的Q7矩阵乘法, 输出32位Q14
fbank_int_8_32 = np.matmul(melbank_int, power_spec_int8)
# 由32 -> 8, 先放大后缩小
shift_32_3 = 31 - int(np.log2(fbank_int_8_32.max())) - 1
shift_8_3 = 31 - 7 - shift_32_3

fbank_int8 = fbank_int_8_32 >> shift_8_3

# 移位的中间过程
fbank_int_32 = fbank_int_8_32 << shift_32_3
```

``` 1*40
fbank_q      = [576963, 975255, 6290326, 7819678, 5987871, 8026614, 4392092, 13918619, 14771801, 24711525, 25452097, 35885818, 31229131, 34576780, 64379582, 36600716, 56713444, 93789555, 87146117, 128106107, 153720103, 113840168, 142410843, 195721344, 254469051, 299935342, 195306591, 200639869, 222922878, 320207772, 372157464, 337569876, 393775861, 595951845, 536641523, 584297774, 709060075, 668311090, 1001260230, 1240229724]

fbank_int    = [571008, 975680, 6290688, 7821760, 5987712, 8026560, 4392320, 13917184, 14704981, 24652318, 25321005, 35731814, 31065803, 34380502, 64294290, 36599264, 56708928, 93783424, 86813657, 127229349, 152826384, 113132474, 141610514, 194679740, 252998397, 298106943, 194408447, 199924143, 221630148, 317844316, 369469576, 335144574, 391085634, 592321596, 533450818, 579603344, 704531890, 663297176,  994356022, 1231572123]

fbank_q8   = [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 1, 2, 3, 2, 3, 5, 5, 7, 9, 6, 8, 11, 15, 17, 11, 11, 13, 19, 22, 20, 23, 35, 31, 34, 42, 39, 59, 73]

fbank_int8 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 3, 1, 3, 5, 4, 7, 8, 6, 7, 11, 14, 17, 11, 11, 12, 18, 21, 19, 22, 34, 31, 33, 41, 38, 58, 72]

fbank_int_8_32  = [0, 0, 192, 384, 192, 384, 128, 768, 807, 1298, 1294, 1912, 1783, 1909, 3718, 2016, 3136, 5312, 4935, 7399, 8985, 6539, 8180, 11480, 15002, 17867, 11369, 11760, 13078, 18932, 22071, 19954, 23048, 35660, 31970, 34636, 42232, 39429, 59733, 74379]

fbank_int_32 = [     0,      0, 3145728, 6291456, 3145728, 6291456, 2097152, 12582912, 13221888, 21266432, 21200896, 31326208, 29212672, 31277056, 60915712, 33030144, 51380224, 87031808, 80855040, 121225216, 147210240, 107134976, 134021120, 188088320, 245792768, 292732928, 186269696, 192675840, 214269952, 310181888, 361611264, 326926336, 377618432, 584253440, 523796480, 567476224, 691929088, 646004736, 978665472, 1218625536]

```

**比较 fbank_q 和 fbank_int , 可以看到无缩放情况下基本一致,有细微的差距.**

**比较 fbank_q8 和 fbank_int8 ,可以看到缩放后的结构也基本一致,有细微的差距.**

**比较 fbank_q 和 fbank_int 与 fbank_int_32, 可以看到,虽然整体趋势一致,但是列表前面数据的差距已经比较明显了**


- **log_fbank计算**

```python
# 浮点计算 后量化
log_fbank = 10*np.log10(fbank)
# Q5.2
log_fbank_q8 = (log_fbank * (2**2)).astype(np.int32)

# 定点计算
def fake_fix_log10(x, Q):
    if x == 0:
        int_r = -65536
    else:
        tmp = x / (2 ** Q)
        r = np.log10(tmp)
        int_r = int(r * (2 ** 15))
    return int_r

# 10 * log10()
log_fbank_int_func = np.frompyfunc(fake_fix_log10, 2, 1)

# 无缩放的定点计算后移位
log_fbank_int = log_fbank_int_func(fbank_int, 22) * 10
shift_32_4 = 31 - int(np.log2(log_fbank_int.max())) - 1
shift_8_4 = 31 - 7 - shift_32_4
log_fbank_int8 = log_fbank_int >> shift_8_4

# 缩放的定点计算后移位
log_fbank_int_32 = log_fbank_int_func(fbank_int_32, 22) * 10
shift_32_5 = 31 - int(np.log2(log_fbank_int_32.max())) - 1
shift_8_5 = 31 - 7 - shift_32_5
log_fbank_int_32_8 = log_fbank_int_32 >> shift_8_5
```

``` 1*40
log_fbank_q8       = [-34, -25,  7, 10,  6, 11,   0, 20, 21, 30, 31, 37, 34, 36, 47, 37, 45, 53, 52, 59, 62, 57, 61, 66, 71, 74, 66, 67, 69, 75, 77, 76, 78, 86, 84, 85, 89, 88, 95, 98]

log_fbank_int8     = [-35, -26,  7, 10,  6, 11,   0, 20, 21, 30, 31, 37, 34, 36, 47, 37, 45, 53, 52, 59, 62, 57, 61, 66, 71, 74, 66, 67, 68, 75, 77, 76, 78, 85, 84, 85, 89, 87, 94, 98]

log_fbank_int_32_8 = [-80, -80, -5,  7, -5,  7, -13, 19, 19, 28, 28, 34, 33, 34, 46, 35, 43, 52, 51, 58, 61, 56, 60, 66, 70, 73, 65, 66, 68, 74, 77, 75, 78, 85, 83, 85, 88, 87, 94, 98]
```

**注意:目前计算过程中Q值丢失,多次缩放以及log计算,导致暂时无法准确跟踪Q值的变化**